<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home - App de Música</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-logo">
        <i class="fas fa-music"></i>
        <span>MusicApp</span>
      </div>
      <nav>
        <ul class="sidebar-nav">
          <li class="sidebar-nav-item">
            <a href="index.html" class="sidebar-nav-link active">
              <i class="fas fa-home"></i>
              <span>Início</span>
            </a>
          </li>
          <li class="sidebar-nav-item">
            <a href="search.html" class="sidebar-nav-link">
              <i class="fas fa-search"></i>
              <span>Pesquisar</span>
            </a>
          </li>
          <li class="sidebar-nav-item">
            <a href="library.html" class="sidebar-nav-link">
              <i class="fas fa-book"></i>
              <span>Sua Biblioteca</span>
            </a>
          </li>
          <li class="sidebar-nav-item">
            <a href="podcasts.html" class="sidebar-nav-link">
              <i class="fas fa-podcast"></i>
              <span>Podcasts</span>
            </a>
          </li>
          <li class="sidebar-nav-item">
            <a href="profile.html" class="sidebar-nav-link profile-link" style="display: none;">
              <i class="fas fa-user"></i>
              <span>Perfil</span>
            </a>
          </li>
          <li class="sidebar-nav-item">
            <a href="login.html" class="sidebar-nav-link login-link">
              <i class="fas fa-sign-in-alt"></i>
              <span>Entrar</span>
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div>
          <button class="btn-icon menu-toggle" id="menuToggle">
            <i class="fas fa-bars"></i>
          </button>
          <h1 class="header-title">Bem-vindo de volta</h1>
        </div>
        <div class="header-actions">
          <button class="btn-icon theme-toggle">
            <i class="fas fa-moon"></i>
          </button>
        </div>
      </header>

      <!-- Carrossel de Destaques -->
      <section class="carousel">
        <div class="carousel-header">
          <h2 class="carousel-title">Destaques</h2>
        </div>
        <div class="carousel-container" id="featuredCarousel">
          <!-- Carregado dinamicamente -->
        </div>
      </section>

      <!-- Músicas de Hoje -->
      <section class="carousel">
        <div class="carousel-header">
          <h2 class="carousel-title">Músicas de Hoje</h2>
          <a href="search.html" class="btn btn-secondary">Ver todas</a>
        </div>
        <div class="carousel-container" id="todaySongs">
          <!-- Carregado dinamicamente -->
        </div>
      </section>

      <!-- Playlists Sugeridas -->
      <section class="carousel">
        <div class="carousel-header">
          <h2 class="carousel-title">Para você</h2>
        </div>
        <div class="carousel-container" id="suggestedPlaylists">
          <!-- Carregado dinamicamente -->
        </div>
      </section>

      <!-- Álbuns Recentes -->
      <section class="carousel">
        <div class="carousel-header">
          <h2 class="carousel-title">Álbuns Recentes</h2>
          <a href="search.html?filter=albums" class="btn btn-secondary">Ver todos</a>
        </div>
        <div class="carousel-container" id="recentAlbums">
          <!-- Carregado dinamicamente -->
        </div>
      </section>

      <!-- Artistas em Ascensão -->
      <section class="carousel">
        <div class="carousel-header">
          <h2 class="carousel-title">Artistas em Ascensão</h2>
        </div>
        <div class="carousel-container" id="trendingArtists">
          <!-- Carregado dinamicamente -->
        </div>
      </section>
    </main>
  </div>

  <!-- Music Player -->
  <div class="music-player">
    <div class="player-track-info">
      <img src="https://via.placeholder.com/56" alt="Track" class="player-track-image">
      <div class="player-track-details">
        <div class="player-track-name">Nenhuma música tocando</div>
        <div class="player-track-artist">Selecione uma música</div>
      </div>
    </div>
    <div class="player-controls">
      <div class="player-buttons">
        <button class="player-button shuffle" title="Embaralhar">
          <i class="fas fa-random"></i>
        </button>
        <button class="player-button prev" title="Anterior">
          <i class="fas fa-step-backward"></i>
        </button>
        <button class="player-button play-pause" title="Reproduzir">
          <i class="fas fa-play"></i>
        </button>
        <button class="player-button next" title="Próxima">
          <i class="fas fa-step-forward"></i>
        </button>
        <button class="player-button repeat" title="Repetir">
          <i class="fas fa-redo"></i>
        </button>
      </div>
      <div class="player-progress">
        <span class="progress-time current-time">0:00</span>
        <div class="progress-bar">
          <div class="progress-fill"></div>
          <div class="progress-handle"></div>
        </div>
        <span class="progress-time duration">0:00</span>
      </div>
    </div>
    <div class="player-actions">
      <button class="player-button lyrics" title="Letras">
        <i class="fas fa-microphone"></i>
      </button>
      <button class="player-button like" title="Curtir">
        <i class="far fa-heart"></i>
      </button>
      <button class="player-button volume" title="Volume">
        <i class="fas fa-volume-up"></i>
      </button>
    </div>
  </div>

  <script src="js/api.js"></script>
  <script src="js/main.js"></script>
  <script src="js/player.js"></script>
  <script>
    // Carregar conteúdo da home
    async function loadHomeContent() {
      try {
        // Carregar recomendações
        const recommendations = await api.getRecommendations();
        
        // Carregar músicas de hoje
        const todaySongs = await api.getSongs(1, 10);
        displayItems(todaySongs.songs || [], 'todaySongs', 'song');
        
        // Carregar álbuns recentes
        const recentAlbums = await api.getAlbums(1, 10);
        displayItems(recentAlbums.albums || [], 'recentAlbums', 'album');
        
        // Carregar destaques
        displayItems(recommendations.featured || [], 'featuredCarousel', 'song');
        
        // Carregar playlists sugeridas
        const playlists = await api.getPlaylists();
        displayItems(playlists.slice(0, 10) || [], 'suggestedPlaylists', 'playlist');
        
      } catch (error) {
        console.error('Erro ao carregar conteúdo:', error);
        // Dados de exemplo para demonstração
        loadExampleData();
      }
    }
    
    function displayItems(items, containerId, type) {
      const container = document.getElementById(containerId);
      if (!container) return;
      
      container.innerHTML = items.map(item => `
        <div class="card" onclick="handleCardClick(${JSON.stringify(item).replace(/"/g, '&quot;')}, '${type}')">
          <img src="${item.image || 'https://via.placeholder.com/300'}" alt="${item.name}" class="card-image" loading="lazy">
          <div class="card-title">${item.name || item.title}</div>
          <div class="card-subtitle">${item.artist || item.artistName || item.description || ''}</div>
        </div>
      `).join('');
    }
    
    function handleCardClick(item, type) {
      if (type === 'song') {
        playSong(item);
      } else if (type === 'album') {
        window.location.href = `album.html?id=${item._id || item.id}`;
      } else if (type === 'playlist') {
        window.location.href = `library.html?playlist=${item._id || item.id}`;
      }
    }
    
    function loadExampleData() {
      const exampleSongs = [
        { id: 1, name: 'Música 1', artist: 'Artista 1', image: 'https://via.placeholder.com/300' },
        { id: 2, name: 'Música 2', artist: 'Artista 2', image: 'https://via.placeholder.com/300' },
        { id: 3, name: 'Música 3', artist: 'Artista 3', image: 'https://via.placeholder.com/300' }
      ];
      displayItems(exampleSongs, 'todaySongs', 'song');
    }
    
    // Inicializar quando a página carregar
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadHomeContent);
    } else {
      loadHomeContent();
    }
  </script>
</body>
</html>

